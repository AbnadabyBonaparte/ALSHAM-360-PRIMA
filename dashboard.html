<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
  <!-- ========================================== -->
  <!-- DOCUMENT & THEME INITIALIZATION            -->
  <!-- ========================================== -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <script>
    (function () {
      const root = document.documentElement;
      const theme = localStorage.getItem('alsham-theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
      const contrast = localStorage.getItem('alsham-contrast') || 'normal';
      root.classList.toggle('dark', theme === 'dark');
      root.classList.toggle('high-contrast', contrast === 'high');
      root.dataset.theme = theme;
      root.dataset.contrast = contrast;
    })();
  </script>

  <!-- ========================================== -->
  <!-- SEO ESSENCIAL & BRANDING                    -->
  <!-- ========================================== -->
  <title>Dashboard Executivo v100.0 — ALSHAM 360° PRIMA</title>
  <meta name="description" content="Dashboard executivo ALSHAM 360° PRIMA v100.0 — CRM enterprise com IA, exports completos, widgets dinâmicos, forecasting e automações omnichannel." />
  <meta name="keywords" content="CRM, dashboard, leads, pipeline, automação, IA, enterprise, analytics, ROI, gamificação" />
  <meta name="author" content="ALSHAM Global" />
  <meta name="robots" content="index, follow" />
  <meta name="language" content="pt-BR" />
  <link rel="canonical" href="https://app.alshamglobal.com.br/dashboard" />

  <!-- Dublin Core -->
  <meta name="DC.title" content="Dashboard Executivo v100.0 — ALSHAM 360° PRIMA" />
  <meta name="DC.creator" content="ALSHAM Global" />
  <meta name="DC.subject" content="CRM, Vendas, Automação" />
  <meta name="DC.description" content="Painel executivo com IA e automação." />
  <meta name="DC.publisher" content="ALSHAM Global" />
  <meta name="DC.date" content="2025-01-01" />
  <meta name="DC.type" content="Text" />
  <meta name="DC.identifier" content="https://app.alshamglobal.com.br/dashboard" />
  <meta name="DC.language" content="pt-BR" />
  <meta name="DC.rights" content="© 2025 ALSHAM Global" />

  <!-- ========================================== -->
  <!-- SECURITY & PRIVACY HEADERS                  -->
  <!-- ========================================== -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff" />
  <meta http-equiv="X-XSS-Protection" content="1; mode=block" />
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin" />
  <meta name="referrer" content="strict-origin-when-cross-origin" />
  <meta http-equiv="Permissions-Policy" content="accelerometer=(), ambient-light-sensor=(), autoplay=(self), battery=(), camera=(), cross-origin-isolated=(), display-capture=(), document-domain=(), encrypted-media=(self), execution-while-not-rendered=(), execution-while-out-of-viewport=(), fullscreen=(self), geolocation=(), gyroscope=(), keyboard-map=(), magnetometer=(), microphone=(), midi=(), navigation-override=(), payment=(self), picture-in-picture=(self), publickey-credentials-get=(), screen-wake-lock=(), sync-xhr=(), usb=(), web-share=(self), xr-spatial-tracking=()" />
  <meta http-equiv="Report-To" content='{"group":"csp","max_age":10886400,"endpoints":[{"url":"https://app.alshamglobal.com.br/api/security/report"}],"include_subdomains":true}' />

  <!-- ========================================== -->
  <!-- MOBILE, PWA & PLATFORM                      -->
  <!-- ========================================== -->
  <meta name="format-detection" content="telephone=no, date=no, address=no, email=no" />
  <meta name="theme-color" content="#0176D3" media="(prefers-color-scheme: light)" />
  <meta name="theme-color" content="#0F172A" media="(prefers-color-scheme: dark)" />
  <meta name="color-scheme" content="light dark" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="ALSHAM 360°" />
  <meta name="application-name" content="ALSHAM 360° PRIMA" />
  <meta name="msapplication-TileColor" content="#0176D3" />
  <meta name="msapplication-navbutton-color" content="#0176D3" />
  <meta name="msapplication-tooltip" content="ALSHAM 360° PRIMA - CRM Enterprise" />
  <meta name="msapplication-starturl" content="/dashboard" />
  <link rel="manifest" href="/manifest.json" crossorigin="use-credentials" />
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png" />
  <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg" />

  <!-- ========================================== -->
  <!-- SOCIAL, OG & TWITTER                        -->
  <!-- ========================================== -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://app.alshamglobal.com.br/dashboard" />
  <meta property="og:title" content="Dashboard Executivo — ALSHAM 360° PRIMA" />
  <meta property="og:description" content="CRM enterprise com IA, automações e analytics em tempo real." />
  <meta property="og:image" content="https://app.alshamglobal.com.br/assets/og-dashboard.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:site_name" content="ALSHAM 360° PRIMA" />
  <meta property="og:locale" content="pt_BR" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@alshamglobal" />
  <meta name="twitter:title" content="Dashboard Executivo — ALSHAM 360° PRIMA" />
  <meta name="twitter:description" content="CRM com IA, exports e automações omnichannel." />
  <meta name="twitter:image" content="https://app.alshamglobal.com.br/assets/og-dashboard.png" />

  <!-- ========================================== -->
  <!-- STRUCTURED DATA                             -->
  <!-- ========================================== -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "ALSHAM 360° PRIMA",
      "operatingSystem": "Web",
      "applicationCategory": "BusinessApplication",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "BRL"
      },
      "featureList": [
        "Automação de Marketing",
        "Forecasting de Vendas",
        "Gamificação",
        "Exportação Multi-formato",
        "Integrações com Supabase"
      ]
    }
  </script>

  <!-- ========================================== -->
  <!-- PREFETCH, PRECONNECT & CRITICAL CSS         -->
  <!-- ========================================== -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin />
  <link rel="dns-prefetch" href="//fonts.googleapis.com" />
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net" />
  <link rel="preload" href="/css/tokens.css" as="style" />
  <link rel="preload" href="/css/style.css" as="style" />
  <link rel="preload" href="/css/dashboard-animations.css" as="style" />
  <link rel="stylesheet" href="/css/tokens.css" />
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="stylesheet" href="/css/dashboard-animations.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tailwindcss/ui@3.0.0/dist/tailwind-ui.min.css" integrity="sha384-XdEIQ7BHEeEqTfL8c1Uk+Q+xoNUskcL/VokZxyGYJyaJBCLTnl1BWxQeF8EkCNn3" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.css" integrity="sha384-dF5Z3jy6SmHgkmqD2k8xmPKzW0fvkYlCY1Z3+z6P6NqMaJS0x1q4oL8Z5MvYkZ2h" crossorigin="anonymous" />

  <!-- ========================================== -->
  <!-- CRITICAL SCRIPTS (DEFER)                    -->
  <!-- ========================================== -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/3.13.5/cdn.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha384-X5JuzMdNkLlG/mU9/2gJpQz9i9k3JUvS8f9SN5GaaGgXfAWXWb4mwZCxy5llSg+1" crossorigin="anonymous" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.min.js" defer></script>
  <script type="module" src="/src/js/dashboard.js" defer></script>
</head>

<body class="font-sans antialiased bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-100" x-data="dashboardApp()" x-init="init()">
  <!-- ========================================== -->
  <!-- ACCESSIBILITY & STATUS OVERLAYS             -->
  <!-- ========================================== -->
  <noscript>
    <div class="fixed inset-0 z-[9999] flex items-center justify-center bg-amber-500 text-white text-lg font-semibold">
      JavaScript está desativado. Ative-o para usar o ALSHAM 360° PRIMA.
    </div>
  </noscript>

  <div id="offline-indicator" class="pointer-events-none fixed right-4 top-4 z-[1100] hidden rounded-2xl bg-red-600 px-4 py-3 text-sm font-semibold shadow-lg" role="status" aria-live="assertive">
    <span class="inline-flex items-center gap-2">
      <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v4m0 4h.01M3 10.236l9-5.196 9 5.196V13a9 9 0 11-18 0z" /></svg>
      Você está offline. Algumas ações serão sincronizadas depois.
    </span>
  </div>

  <div id="page-loading" class="fixed inset-0 z-[1080] hidden items-center justify-center bg-slate-900/40 backdrop-blur">
    <div class="rounded-2xl bg-white p-6 shadow-xl dark:bg-slate-900">
      <div class="mx-auto mb-4 h-12 w-12 animate-spin rounded-full border-4 border-blue-600 border-t-transparent"></div>
      <p class="text-center text-sm font-semibold">Carregando seu cockpit executivo...</p>
    </div>
  </div>

  <a href="#conteudo-principal" class="focus-visible:outline-primary-500 absolute left-4 top-4 -translate-y-full rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white focus-visible:translate-y-0">Pular para conteúdo principal</a>

  <!-- ========================================== -->
  <!-- LAYOUT PRINCIPAL                            -->
  <!-- ========================================== -->
  <div class="flex min-h-screen">
    <!-- SIDEBAR -->
    <aside id="sidebar" class="scrollbar-thin scrollbar-track-transparent scrollbar-thumb-slate-400/60 sticky top-0 hidden h-screen w-80 flex-none border-r border-slate-200 bg-white/80 backdrop-blur-xl transition-all duration-200 dark:border-slate-800 dark:bg-slate-900/80 lg:block" aria-label="Navegação principal">
      <div class="flex h-16 items-center justify-between border-b border-slate-200 px-6 dark:border-slate-800">
        <div class="flex items-center gap-3">
          <img src="/icons/favicon-32x32.png" alt="Logo ALSHAM" class="h-8 w-8" />
          <span class="text-lg font-bold">ALSHAM 360°</span>
        </div>
        <button type="button" class="rounded-full bg-slate-100 p-2 text-slate-500 hover:text-blue-600 dark:bg-slate-800" x-on:click="toggleSidebar()" aria-label="Recolher navegação">
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="m18 12-6-6-6 6" /></svg>
        </button>
      </div>
      <nav class="space-y-6 overflow-y-auto px-6 py-6 text-sm" x-data="{ open: null }">
        <template x-for="group in navigation" :key="group.id">
          <div class="space-y-2">
            <button class="flex w-full items-center justify-between rounded-xl bg-slate-100 px-4 py-3 font-semibold text-slate-700 transition hover:bg-blue-100 hover:text-blue-700 dark:bg-slate-800 dark:text-slate-200 dark:hover:bg-slate-700" x-on:click="open = open === group.id ? null : group.id" :aria-expanded="open === group.id">
              <span class="flex items-center gap-3">
                <span class="inline-flex h-8 w-8 items-center justify-center rounded-lg bg-blue-500/10 text-blue-600 dark:bg-blue-400/10 dark:text-blue-300" aria-hidden="true" x-html="group.icon"></span>
                <span x-text="group.label"></span>
              </span>
              <svg class="h-4 w-4 transition" :class="{ 'rotate-180 text-blue-600': open === group.id }" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="m19 9-7 7-7-7" /></svg>
            </button>
            <div class="space-y-1" x-cloak x-show="open === group.id" x-collapse>
              <template x-for="link in group.links" :key="link.href">
                <a :href="link.href" class="flex items-center justify-between rounded-lg px-4 py-2 text-slate-600 transition hover:bg-blue-50 hover:text-blue-700 dark:text-slate-300 dark:hover:bg-slate-800 dark:hover:text-white">
                  <span x-text="link.label"></span>
                  <span class="text-xs font-semibold uppercase tracking-wide text-blue-500" x-show="link.badge" x-text="link.badge"></span>
                </a>
              </template>
            </div>
          </div>
        </template>
        <div class="pt-4">
          <a href="/login" class="flex items-center gap-3 rounded-xl border border-slate-200 px-4 py-3 font-semibold transition hover:border-blue-400 hover:text-blue-600 dark:border-slate-700 dark:hover:border-blue-400" aria-label="Ir para login">Login</a>
          <a href="/logout" class="mt-2 flex items-center gap-3 rounded-xl border border-slate-200 px-4 py-3 font-semibold transition hover:border-rose-400 hover:text-rose-600 dark:border-slate-700" aria-label="Encerrar sessão">Sair</a>
        </div>
      </nav>
    </aside>

    <!-- CONTEÚDO PRINCIPAL -->
    <div class="flex min-h-screen flex-1 flex-col">
      <header class="sticky top-0 z-40 border-b border-slate-200 bg-white/75 backdrop-blur-xl transition dark:border-slate-800 dark:bg-slate-900/80">
        <div class="flex h-16 items-center justify-between px-4 sm:px-6 lg:px-10">
          <div class="flex items-center gap-3">
            <button type="button" class="rounded-full bg-slate-100 p-2 text-slate-600 hover:text-blue-600 dark:bg-slate-800 lg:hidden" x-on:click="toggleSidebar()" aria-label="Abrir navegação">
              <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" /></svg>
            </button>
            <div>
              <p class="text-xs font-semibold uppercase tracking-wide text-blue-600">ALSHAM 360° PRIMA</p>
              <h1 class="text-xl font-bold">Cockpit Executivo</h1>
            </div>
            <span class="rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700 dark:bg-emerald-500/10 dark:text-emerald-300">v100.0</span>
          </div>
          <div class="flex items-center gap-3">
            <label class="sr-only" for="global-search">Buscar</label>
            <div class="relative">
              <input id="global-search" type="search" x-model="filters.search" x-on:input.debounce.400ms="applyFilters" placeholder="Buscar leads, deals, tarefas..." class="w-56 rounded-full border border-slate-200 bg-white px-4 py-2 text-sm shadow-sm transition focus:border-blue-500 focus:outline-none focus:ring dark:border-slate-700 dark:bg-slate-900" />
              <span class="pointer-events-none absolute inset-y-0 right-3 flex items-center text-slate-400">
                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-4.35-4.35M11 19a8 8 0 1 1 0-16 8 8 0 0 1 0 16z" /></svg>
              </span>
            </div>
            <button type="button" class="rounded-full bg-slate-100 p-2 text-slate-500 transition hover:text-blue-600 dark:bg-slate-800" x-on:click="toggleTheme()" aria-label="Alternar tema">
              <svg x-show="theme === 'light'" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364-.707.707M6.343 17.657l-.707.707m12.728 0-.707-.707M6.343 6.343l-.707-.707M16 12a4 4 0 1 1-8 0 4 4 0 0 1 8 0z" /></svg>
              <svg x-show="theme === 'dark'" x-cloak class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" /></svg>
            </button>
            <button type="button" class="relative rounded-full bg-slate-100 p-2 text-slate-500 hover:text-blue-600 dark:bg-slate-800" aria-label="Notificações" x-on:click="toggleNotifications">
              <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0 1 18 14.158V11a6.002 6.002 0 0 0-4-5.659V5a2 2 0 1 0-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0a3 3 0 1 1-6 0" /></svg>
              <span class="absolute -right-0.5 -top-0.5 h-2.5 w-2.5 rounded-full bg-rose-500"></span>
            </button>
            <button type="button" class="flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-1 text-sm font-semibold shadow-sm transition hover:border-blue-500 dark:border-slate-700 dark:bg-slate-900" aria-haspopup="true" x-on:click="toggleAccount">
              <span class="h-8 w-8 rounded-full bg-gradient-to-tr from-blue-500 to-violet-500" aria-hidden="true"></span>
              <span>Citizen Supremo</span>
              <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="m19 9-7 7-7-7" /></svg>
            </button>
          </div>
        </div>
      </header>

      <main id="conteudo-principal" class="flex-1 space-y-10 px-4 pb-10 pt-8 sm:px-6 lg:px-10">
        <!-- HERO -->
        <section class="rounded-3xl bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 p-8 text-white shadow-xl">
          <div class="flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between">
            <div>
              <p class="text-sm font-semibold uppercase tracking-[0.2em] text-blue-100">Bem-vindo(a)</p>
              <h2 class="mt-2 text-3xl font-bold sm:text-4xl">Citizen Supremo, seu cockpit está pronto para decolar</h2>
              <p class="mt-4 max-w-3xl text-base text-blue-100">Monitore KPIs, oportunidades, squads e automações com inteligência aumentada, previsões em tempo real e insights gerados por IA.</p>
              <div class="mt-6 flex flex-wrap gap-3 text-sm">
                <button type="button" class="inline-flex items-center gap-2 rounded-full bg-white/15 px-4 py-2 font-semibold backdrop-blur transition hover:bg-white/25" x-on:click="openModal('aiCopilot')">
                  <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v4m0 10v4m9-9h-4M7 12H3m15.364 6.364-2.828-2.828M8.464 8.464 5.636 5.636m0 12.728 2.828-2.828m9.9-9.9L18.364 5.636" /></svg>
                  Abrir Copilot IA
                </button>
                <button type="button" class="inline-flex items-center gap-2 rounded-full bg-white/15 px-4 py-2 font-semibold backdrop-blur transition hover:bg-white/25" x-on:click="openModal('share')">
                  Compartilhar insights
                </button>
              </div>
            </div>
            <div class="grid gap-4 text-sm">
              <div class="flex items-center gap-3 rounded-2xl bg-white/15 px-4 py-3">
                <span class="flex h-12 w-12 items-center justify-center rounded-full bg-white/20 text-white" aria-hidden="true">98</span>
                <div>
                  <p class="text-xs uppercase tracking-wide text-blue-100">Pontuação de Saúde</p>
                  <p class="text-lg font-semibold">98 / 100</p>
                </div>
              </div>
              <div class="flex items-center gap-3 rounded-2xl bg-white/15 px-4 py-3">
                <span class="flex h-12 w-12 items-center justify-center rounded-full bg-white/20 text-white" aria-hidden="true">24h</span>
                <div>
                  <p class="text-xs uppercase tracking-wide text-blue-100">SLA Médio</p>
                  <p class="text-lg font-semibold">24h 12m</p>
                </div>
              </div>
              <div class="flex items-center gap-3 rounded-2xl bg-white/15 px-4 py-3">
                <span class="flex h-12 w-12 items-center justify-center rounded-full bg-white/20 text-white" aria-hidden="true">+12%</span>
                <div>
                  <p class="text-xs uppercase tracking-wide text-blue-100">Forecast 90 dias</p>
                  <p class="text-lg font-semibold">↑ 12% vs. meta</p>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- FILTROS -->
        <section class="rounded-3xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900">
          <h2 class="text-lg font-semibold">Filtros Inteligentes</h2>
          <p class="mt-1 text-sm text-slate-500 dark:text-slate-400">Combine filtros para refinar KPIs e relatórios em tempo real.</p>
          <div class="mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-4">
            <label class="space-y-1 text-sm">
              <span class="font-medium">Período</span>
              <select class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring dark:border-slate-700 dark:bg-slate-950" x-model="filters.period" x-on:change="applyFilters">
                <option value="7d">Últimos 7 dias</option>
                <option value="30d">Últimos 30 dias</option>
                <option value="90d">Últimos 90 dias</option>
                <option value="ytd">Ano corrente</option>
              </select>
            </label>
            <label class="space-y-1 text-sm">
              <span class="font-medium">Status do Lead</span>
              <select class="w-full rounded-lg border border-slate-200 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring dark:border-slate-700 dark:bg-slate-950" x-model="filters.status" x-on:change="applyFilters">
                <option value="all">Todos</option>
                <option value="new">Novo</option>
                <option value="qualified">Qualificado</option>
                <option value="negotiation">Negociação</option>
                <option value="won">Ganho</option>
              </select>
            </label>
            <label class="space-y-1 text-sm">
              <span class="font-medium">Origem</span>
              <select class="w-full rounded-lg border border-slate-200 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring dark:border-slate-700 dark:bg-slate-950" x-model="filters.source" x-on:change="applyFilters">
                <option value="all">Todos</option>
                <option value="web">Web</option>
                <option value="ads">Ads</option>
                <option value="email">Email</option>
                <option value="partners">Parceiros</option>
              </select>
            </label>
            <label class="space-y-1 text-sm">
              <span class="font-medium">Squad</span>
              <select class="w-full rounded-lg border border-slate-200 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring dark:border-slate-700 dark:bg-slate-950" x-model="filters.squad" x-on:change="applyFilters">
                <option value="alpha">Alpha</option>
                <option value="omega">Omega</option>
                <option value="phoenix">Phoenix</option>
                <option value="tiger">Tiger</option>
              </select>
            </label>
          </div>
          <div class="mt-4 flex flex-wrap gap-3 text-xs font-semibold">
            <button type="button" class="rounded-full border border-blue-500 px-4 py-2 text-blue-600 transition hover:bg-blue-50 dark:hover:bg-blue-500/10" x-on:click="saveFilter()">Salvar filtro</button>
            <button type="button" class="rounded-full border border-slate-200 px-4 py-2 text-slate-600 transition hover:bg-slate-100 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800" x-on:click="resetFilters()">Limpar</button>
            <span class="inline-flex items-center gap-2 rounded-full bg-emerald-100 px-4 py-2 text-emerald-700 dark:bg-emerald-500/10 dark:text-emerald-300">
              <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="m5 13 4 4L19 7" /></svg>
              SLA cumprido em 97%
            </span>
          </div>
        </section>

        <!-- KPIs -->
        <section class="space-y-6">
          <div class="flex items-center justify-between">
            <h2 class="text-lg font-semibold">Indicadores críticos</h2>
            <div class="flex flex-wrap gap-2 text-xs font-semibold">
              <button type="button" class="rounded-full border border-slate-200 px-3 py-2 hover:border-blue-500 dark:border-slate-700" x-on:click="exportKpis('csv')">Exportar CSV</button>
              <button type="button" class="rounded-full border border-slate-200 px-3 py-2 hover:border-blue-500 dark:border-slate-700" x-on:click="exportKpis('pdf')">Exportar PDF</button>
              <button type="button" class="rounded-full border border-slate-200 px-3 py-2 hover:border-blue-500 dark:border-slate-700" x-on:click="exportKpis('xlsx')">Exportar Excel</button>
              <button type="button" class="rounded-full border border-slate-200 px-3 py-2 hover:border-blue-500 dark:border-slate-700" x-on:click="exportKpis('ppt')">Exportar PPT</button>
            </div>
          </div>
          <div class="grid gap-4 md:grid-cols-2 xl:grid-cols-4" x-ref="kpiGrid">
            <template x-for="card in kpis" :key="card.id">
              <article class="group relative overflow-hidden rounded-3xl border border-slate-200 bg-white p-5 shadow-sm transition hover:-translate-y-1 hover:border-blue-300 hover:shadow-lg dark:border-slate-800 dark:bg-slate-900" x-on:click="openKpi(card)" tabindex="0" role="button" :aria-label="`Abrir detalhes do indicador ${card.title}`">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-xs font-semibold uppercase tracking-wide text-slate-500" x-text="card.category"></p>
                    <h3 class="mt-1 text-lg font-semibold" x-text="card.title"></h3>
                  </div>
                  <span class="rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600 dark:bg-slate-800 dark:text-slate-300" x-text="card.period"></span>
                </div>
                <p class="mt-3 text-3xl font-bold" x-text="card.value"></p>
                <p class="mt-2 flex items-center gap-2 text-sm" :class="card.trend >= 0 ? 'text-emerald-600' : 'text-rose-600'">
                  <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="m5 12 5 5L20 7" x-show="card.trend >= 0"></path><path stroke-linecap="round" stroke-linejoin="round" d="m19 12-5-5L4 17" x-show="card.trend < 0"></path></svg>
                  <span x-text="card.trendLabel"></span>
                </p>
                <canvas :id="`spark-${card.id}`" class="mt-4 h-16" aria-hidden="true"></canvas>
                <div class="mt-4 flex items-center justify-between text-xs text-slate-500">
                  <span x-text="card.subtitle"></span>
                  <span class="flex items-center gap-1 font-semibold text-blue-600">Drill-down <svg class="h-3 w-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="m5 8 7 7 7-7" /></svg></span>
                </div>
              </article>
            </template>
          </div>
        </section>

        <!-- GRÁFICOS PRINCIPAIS -->
        <section class="grid gap-6 xl:grid-cols-2">
          <article class="rounded-3xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900">
            <header class="flex items-center justify-between">
              <div>
                <h3 class="text-lg font-semibold">Pipeline de Receita</h3>
                <p class="text-sm text-slate-500 dark:text-slate-400">Desempenho por estágio com meta semanal.</p>
              </div>
              <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold transition hover:border-blue-500 dark:border-slate-700" x-on:click="openModal('pipelineForecast')">Drill-down</button>
            </header>
            <canvas id="chart-pipeline" class="mt-6 h-72" role="img" aria-label="Gráfico de linhas com pipeline de receita"></canvas>
          </article>
          <article class="rounded-3xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900">
            <header class="flex items-center justify-between">
              <div>
                <h3 class="text-lg font-semibold">Distribuição de Leads</h3>
                <p class="text-sm text-slate-500 dark:text-slate-400">Comparativo por origem com visão de funil.</p>
              </div>
              <div class="flex gap-2 text-xs font-semibold">
                <button type="button" class="rounded-full border border-slate-200 px-3 py-1 transition hover:border-blue-500 dark:border-slate-700" x-on:click="toggleLeadView('donut')">Donut</button>
                <button type="button" class="rounded-full border border-slate-200 px-3 py-1 transition hover:border-blue-500 dark:border-slate-700" x-on:click="toggleLeadView('funnel')">Funil</button>
              </div>
            </header>
            <canvas id="chart-leads" class="mt-6 h-72" role="img" aria-label="Gráfico de donut com distribuição de leads"></canvas>
          </article>
          <article class="rounded-3xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900 xl:col-span-2">
            <header class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
              <div>
                <h3 class="text-lg font-semibold">Heatmap de Adoção</h3>
                <p class="text-sm text-slate-500 dark:text-slate-400">Mapa de calor diário por squad com IA destacando outliers.</p>
              </div>
              <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold transition hover:border-blue-500 dark:border-slate-700" x-on:click="openModal('engagementHeatmap')">Ver detalhes</button>
            </header>
            <div class="mt-6 grid grid-cols-7 gap-2 text-center text-xs" role="table" aria-label="Heatmap de adoção semanal">
              <template x-for="cell in heatmap" :key="cell.id">
                <div class="relative rounded-lg p-4" :style="`background: ${cell.color}`" role="cell" :aria-label="cell.label">
                  <span class="font-semibold text-slate-900/80" x-text="cell.value"></span>
                </div>
              </template>
            </div>
          </article>
        </section>

        <!-- MAPA & COHORT -->
        <section class="grid gap-6 xl:grid-cols-[1.5fr_1fr]">
          <article class="rounded-3xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900">
            <header class="flex items-center justify-between">
              <div>
                <h3 class="text-lg font-semibold">Mapa de Oportunidades</h3>
                <p class="text-sm text-slate-500 dark:text-slate-400">Distribuição geográfica de deals ativos.</p>
              </div>
              <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold transition hover:border-blue-500 dark:border-slate-700" x-on:click="syncMap()">Atualizar</button>
            </header>
            <div id="map-dashboard" class="mt-6 h-80 rounded-2xl" role="img" aria-label="Mapa com oportunidades"></div>
          </article>
          <article class="rounded-3xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900">
            <header class="flex items-center justify-between">
              <div>
                <h3 class="text-lg font-semibold">Análise de Cohort</h3>
                <p class="text-sm text-slate-500 dark:text-slate-400">Retenção mensal por data de entrada.</p>
              </div>
              <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold transition hover:border-blue-500 dark:border-slate-700" x-on:click="openModal('cohortDetails')">Abrir cohort</button>
            </header>
            <div class="mt-6 space-y-3 text-xs">
              <template x-for="cohort in cohorts" :key="cohort.month">
                <div>
                  <div class="flex items-center justify-between font-semibold">
                    <span x-text="cohort.month"></span>
                    <span x-text="`${cohort.retention}%`"></span>
                  </div>
                  <div class="mt-1 h-2 rounded-full bg-slate-200 dark:bg-slate-800">
                    <div class="h-2 rounded-full bg-gradient-to-r from-blue-500 to-purple-500" :style="`width: ${cohort.retention}%`" aria-hidden="true"></div>
                  </div>
                </div>
              </template>
            </div>
          </article>
        </section>

        <!-- FEED & TABELAS -->
        <section class="grid gap-6 xl:grid-cols-[1.2fr_1fr]">
          <article class="rounded-3xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900">
            <header class="flex flex-wrap items-center justify-between gap-3">
              <div>
                <h3 class="text-lg font-semibold">Atividade Recente</h3>
                <p class="text-sm text-slate-500 dark:text-slate-400">Timeline colaborativa com ações do time.</p>
              </div>
              <div class="flex flex-wrap gap-2 text-xs font-semibold">
                <button type="button" class="rounded-full border border-slate-200 px-3 py-1 transition hover:border-blue-500 dark:border-slate-700" x-on:click="exportActivity('csv')">CSV</button>
                <button type="button" class="rounded-full border border-slate-200 px-3 py-1 transition hover:border-blue-500 dark:border-slate-700" x-on:click="exportActivity('pdf')">PDF</button>
                <button type="button" class="rounded-full border border-slate-200 px-3 py-1 transition hover:border-blue-500 dark:border-slate-700" x-on:click="exportActivity('xlsx')">Excel</button>
                <button type="button" class="rounded-full border border-slate-200 px-3 py-1 transition hover:border-blue-500 dark:border-slate-700" x-on:click="exportActivity('ppt')">PPT</button>
              </div>
            </header>
            <ol class="mt-6 space-y-4" role="list">
              <template x-for="item in activity" :key="item.id">
                <li class="rounded-2xl border border-slate-200 p-4 transition hover:border-blue-300 dark:border-slate-800" :class="item.critical ? 'bg-rose-50/60 dark:bg-rose-500/10' : 'bg-slate-50/60 dark:bg-slate-900'">
                  <div class="flex items-start justify-between gap-3">
                    <div class="space-y-1">
                      <p class="text-sm font-semibold" x-text="item.title"></p>
                      <p class="text-xs text-slate-500" x-text="item.description"></p>
                    </div>
                    <span class="rounded-full bg-slate-900/10 px-3 py-1 text-[11px] font-semibold uppercase tracking-wide text-slate-600 dark:bg-slate-50/10 dark:text-slate-300" x-text="item.time"></span>
                  </div>
                  <div class="mt-3 flex flex-wrap gap-2 text-xs">
                    <template x-for="tag in item.tags" :key="tag">
                      <span class="rounded-full bg-blue-500/10 px-3 py-1 font-semibold text-blue-600 dark:bg-blue-400/10 dark:text-blue-200" x-text="tag"></span>
                    </template>
                  </div>
                </li>
              </template>
            </ol>
          </article>
          <article class="rounded-3xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900">
            <header class="flex items-center justify-between">
              <div>
                <h3 class="text-lg font-semibold">Leaderboard Gamificado</h3>
                <p class="text-sm text-slate-500 dark:text-slate-400">Rank do trimestre com conquistas.</p>
              </div>
              <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold transition hover:border-blue-500 dark:border-slate-700" x-on:click="launchCelebration()">Disparar confete</button>
            </header>
            <ul class="mt-6 space-y-3 text-sm" role="list">
              <template x-for="member in leaderboard" :key="member.id">
                <li class="flex items-center justify-between rounded-2xl border border-slate-200 px-4 py-3 dark:border-slate-800">
                  <div class="flex items-center gap-3">
                    <span class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-tr from-blue-500 to-purple-500 text-white font-semibold" x-text="member.rank"></span>
                    <div>
                      <p class="font-semibold" x-text="member.name"></p>
                      <p class="text-xs text-slate-500" x-text="member.badge"></p>
                    </div>
                  </div>
                  <div class="text-right">
                    <p class="text-sm font-semibold" x-text="`${member.points} pts`"></p>
                    <p class="text-xs text-emerald-600" x-text="member.delta"></p>
                  </div>
                </li>
              </template>
            </ul>
          </article>
        </section>

        <!-- WIDGETS CUSTOMIZÁVEIS -->
        <section class="rounded-3xl border border-dashed border-slate-300 bg-white p-6 shadow-sm dark:border-slate-700 dark:bg-slate-900" x-data="{ editing: false }">
          <header class="flex flex-wrap items-center justify-between gap-3">
            <div>
              <h3 class="text-lg font-semibold">Área de Widgets Dinâmicos</h3>
              <p class="text-sm text-slate-500 dark:text-slate-400">Reorganize cards por drag & drop e salve layouts personalizados.</p>
            </div>
            <div class="flex gap-2 text-xs font-semibold">
              <button type="button" class="rounded-full border border-slate-200 px-3 py-2 hover:border-blue-500 dark:border-slate-700" x-on:click="toggleWidgetEdit">Modo edição</button>
              <button type="button" class="rounded-full border border-blue-500 px-3 py-2 text-blue-600 transition hover:bg-blue-50 dark:hover:bg-blue-500/10" x-on:click="saveLayout">Salvar layout</button>
            </div>
          </header>
          <div class="mt-6 grid gap-4 md:grid-cols-2 xl:grid-cols-3" x-ref="widgetZone">
            <template x-for="widget in widgets" :key="widget.id">
              <div class="rounded-3xl border border-slate-200 bg-slate-50 p-5 shadow-sm transition dark:border-slate-700 dark:bg-slate-900" :data-widget-id="widget.id">
                <div class="flex items-center justify-between">
                  <h4 class="text-base font-semibold" x-text="widget.title"></h4>
                  <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold transition hover:border-blue-500 dark:border-slate-700" x-on:click="openWidget(widget.id)">Abrir</button>
                </div>
                <p class="mt-2 text-sm text-slate-500" x-text="widget.description"></p>
                <div class="mt-4 rounded-2xl bg-white p-4 text-sm shadow-inner dark:bg-slate-950" x-html="widget.content"></div>
              </div>
            </template>
          </div>
        </section>
      </main>

      <footer class="border-t border-slate-200 bg-white/75 px-4 py-6 text-xs text-slate-500 backdrop-blur dark:border-slate-800 dark:bg-slate-900/80 sm:px-6 lg:px-10">
        <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
          <p>© <span x-text="new Date().getFullYear()"></span> ALSHAM Global. Todos os direitos reservados.</p>
          <div class="flex flex-wrap gap-3">
            <a href="/privacidade" class="hover:text-blue-600">Privacidade</a>
            <a href="/seguranca" class="hover:text-blue-600">Segurança</a>
            <a href="/status" class="hover:text-blue-600">Status</a>
            <a href="/roadmap" class="hover:text-blue-600">Roadmap</a>
          </div>
        </div>
      </footer>
    </div>
  </div>

  <!-- ========================================== -->
  <!-- MODAIS & SHEETS                             -->
  <!-- ========================================== -->
  <div x-show="modal === 'aiCopilot'" x-cloak class="fixed inset-0 z-[1200] flex items-center justify-center bg-slate-900/70 p-4 backdrop-blur" role="dialog" aria-modal="true" aria-labelledby="modal-copilot-title">
    <div class="w-full max-w-3xl rounded-3xl bg-white p-6 shadow-2xl dark:bg-slate-900">
      <header class="flex items-start justify-between">
        <div>
          <h2 id="modal-copilot-title" class="text-xl font-semibold">Copilot IA</h2>
          <p class="text-sm text-slate-500 dark:text-slate-400">Gere insights estratégicos e próximos passos.</p>
        </div>
        <button type="button" class="rounded-full bg-slate-100 p-2 text-slate-500 hover:text-blue-600 dark:bg-slate-800" x-on:click="closeModal()" aria-label="Fechar Copilot">
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6m0 12L6 6" /></svg>
        </button>
      </header>
      <div class="mt-6 space-y-4 text-sm">
        <textarea class="min-h-[120px] w-full rounded-2xl border border-slate-200 px-4 py-3 focus:border-blue-500 focus:outline-none focus:ring dark:border-slate-700 dark:bg-slate-950" placeholder="Faça uma pergunta: quais campanhas devo priorizar esta semana?" x-model="copilot.prompt"></textarea>
        <button type="button" class="inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-blue-600 to-purple-600 px-5 py-3 text-sm font-semibold text-white shadow-lg transition hover:shadow-xl" x-on:click="askCopilot">
          <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13c0-1.657 0-2.486.513-3.09a2 2 0 0 1 .397-.332C6.57 9 7.38 9 9 9h6c1.62 0 2.43 0 3.09.578a2 2 0 0 1 .397.332C19 10.514 19 11.343 19 13c0 1.657 0 2.486-.513 3.09a2 2 0 0 1-.397.332C17.43 17 16.62 17 15 17H9c-1.62 0-2.43 0-3.09-.578a2 2 0 0 1-.397-.332C5 15.486 5 14.657 5 13Z" /><path stroke-linecap="round" stroke-linejoin="round" d="m9 9 .553-1.106A2 2 0 0 1 11.382 7h1.236a2 2 0 0 1 1.829 1.106L15 9M9 17l-.553 1.106A2 2 0 0 1 6.618 19H5" /></svg>
          Gerar Insight
        </button>
        <div class="rounded-2xl border border-slate-200 bg-slate-50 p-4 text-sm dark:border-slate-700 dark:bg-slate-950" x-text="copilot.answer || 'O Copilot responderá aqui com recomendações baseadas nos seus dados.'"></div>
      </div>
    </div>
  </div>

  <div x-show="modal === 'pipelineForecast'" x-cloak class="fixed inset-0 z-[1200] flex items-center justify-center bg-slate-900/70 p-4 backdrop-blur" role="dialog" aria-modal="true" aria-labelledby="modal-pipeline-title">
    <div class="w-full max-w-4xl rounded-3xl bg-white p-6 shadow-2xl dark:bg-slate-900">
      <header class="flex items-start justify-between">
        <div>
          <h2 id="modal-pipeline-title" class="text-xl font-semibold">Pipeline Forecast - Detalhamento</h2>
          <p class="text-sm text-slate-500 dark:text-slate-400">Visualize cenários, riscos e próximos passos.</p>
        </div>
        <button type="button" class="rounded-full bg-slate-100 p-2 text-slate-500 hover:text-blue-600 dark:bg-slate-800" x-on:click="closeModal()" aria-label="Fechar">
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6m0 12L6 6" /></svg>
        </button>
      </header>
      <div class="mt-6 grid gap-4 lg:grid-cols-2">
        <div class="rounded-2xl border border-slate-200 bg-slate-50 p-4 text-sm dark:border-slate-700 dark:bg-slate-950">
          <h3 class="text-sm font-semibold">Cenário Base</h3>
          <ul class="mt-2 space-y-2">
            <li>Meta QTD: <strong>R$ 4,8M</strong></li>
            <li>Probabilidade ponderada: <strong>72%</strong></li>
            <li>Gap vs. meta: <strong>R$ 1,1M</strong></li>
          </ul>
        </div>
        <div class="rounded-2xl border border-slate-200 bg-slate-50 p-4 text-sm dark:border-slate-700 dark:bg-slate-950">
          <h3 class="text-sm font-semibold">Recomendações do Copilot</h3>
          <ol class="mt-2 list-decimal space-y-2 pl-5">
            <li>Priorizar oportunidades com score &gt; 85.</li>
            <li>Ativar automação de retomada para leads frios.</li>
            <li>Agendar coaching com squad Phoenix.</li>
          </ol>
        </div>
      </div>
      <div class="mt-6 rounded-2xl border border-slate-200 p-4 dark:border-slate-800">
        <canvas id="chart-pipeline-detailed" class="h-64" aria-label="Gráfico de barras com previsão detalhada"></canvas>
      </div>
    </div>
  </div>

  <div x-show="modal === 'share'" x-cloak class="fixed inset-0 z-[1200] flex items-center justify-center bg-slate-900/70 p-4 backdrop-blur" role="dialog" aria-modal="true" aria-labelledby="modal-share-title">
    <div class="w-full max-w-lg rounded-3xl bg-white p-6 shadow-2xl dark:bg-slate-900">
      <header class="flex items-start justify-between">
        <div>
          <h2 id="modal-share-title" class="text-xl font-semibold">Compartilhar insights</h2>
          <p class="text-sm text-slate-500 dark:text-slate-400">Gere um link seguro ou exporte o snapshot do dashboard.</p>
        </div>
        <button type="button" class="rounded-full bg-slate-100 p-2 text-slate-500 hover:text-blue-600 dark:bg-slate-800" x-on:click="closeModal()" aria-label="Fechar">
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6m0 12L6 6" /></svg>
        </button>
      </header>
      <div class="mt-6 space-y-4 text-sm">
        <label class="block">
          <span class="font-semibold">Link público expirável</span>
          <input type="url" readonly value="https://app.alshamglobal.com.br/share/dashboard?v=100" class="mt-2 w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-sm dark:border-slate-700 dark:bg-slate-950" />
        </label>
        <div class="flex flex-wrap gap-2 text-xs font-semibold">
          <button type="button" class="rounded-full border border-slate-200 px-3 py-2 hover:border-blue-500 dark:border-slate-700" x-on:click="exportKpis('pdf')">Exportar PDF</button>
          <button type="button" class="rounded-full border border-slate-200 px-3 py-2 hover:border-blue-500 dark:border-slate-700" x-on:click="exportKpis('ppt')">Exportar PPT</button>
          <button type="button" class="rounded-full border border-slate-200 px-3 py-2 hover:border-blue-500 dark:border-slate-700" x-on:click="exportKpis('xlsx')">Exportar Excel</button>
        </div>
        <p class="text-xs text-slate-500 dark:text-slate-400">Atenção: links expiram após 48 horas e exigem autenticação por token temporário.</p>
      </div>
    </div>
  </div>

  <div x-show="modal === 'cohortDetails'" x-cloak class="fixed inset-0 z-[1200] flex items-center justify-center bg-slate-900/70 p-4 backdrop-blur" role="dialog" aria-modal="true" aria-labelledby="modal-cohort-title">
    <div class="w-full max-w-2xl rounded-3xl bg-white p-6 shadow-2xl dark:bg-slate-900">
      <header class="flex items-start justify-between">
        <div>
          <h2 id="modal-cohort-title" class="text-xl font-semibold">Cohort completo</h2>
          <p class="text-sm text-slate-500 dark:text-slate-400">Detalhamento de retenção por mês de entrada.</p>
        </div>
        <button type="button" class="rounded-full bg-slate-100 p-2 text-slate-500 hover:text-blue-600 dark:bg-slate-800" x-on:click="closeModal()" aria-label="Fechar">
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6m0 12L6 6" /></svg>
        </button>
      </header>
      <div class="mt-6 overflow-x-auto">
        <table class="min-w-full divide-y divide-slate-200 text-sm dark:divide-slate-800">
          <thead class="bg-slate-50 dark:bg-slate-900/50">
            <tr>
              <th scope="col" class="px-4 py-2 text-left font-semibold">Mês</th>
              <th scope="col" class="px-4 py-2 text-left font-semibold">M+1</th>
              <th scope="col" class="px-4 py-2 text-left font-semibold">M+2</th>
              <th scope="col" class="px-4 py-2 text-left font-semibold">M+3</th>
              <th scope="col" class="px-4 py-2 text-left font-semibold">M+4</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-slate-100 dark:divide-slate-800">
            <template x-for="row in cohorts" :key="row.month">
              <tr>
                <th scope="row" class="px-4 py-2 text-left font-semibold" x-text="row.month"></th>
                <td class="px-4 py-2" x-text="`${Math.max(0, row.retention - 5)}%`"></td>
                <td class="px-4 py-2" x-text="`${Math.max(0, row.retention - 12)}%`"></td>
                <td class="px-4 py-2" x-text="`${Math.max(0, row.retention - 20)}%`"></td>
                <td class="px-4 py-2" x-text="`${Math.max(0, row.retention - 28)}%`"></td>
              </tr>
            </template>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Toasts -->
  <div class="fixed bottom-6 right-6 z-[1300] space-y-3" aria-live="assertive" aria-atomic="true">
    <template x-for="toast in toasts" :key="toast.id">
      <div class="flex items-start gap-3 rounded-2xl border border-slate-200 bg-white p-4 shadow-lg dark:border-slate-700 dark:bg-slate-900">
        <div class="mt-1 text-blue-500" aria-hidden="true">⚡</div>
        <div>
          <p class="text-sm font-semibold" x-text="toast.title"></p>
          <p class="text-xs text-slate-500" x-text="toast.message"></p>
        </div>
        <button type="button" class="text-xs font-semibold uppercase text-blue-600" x-on:click="dismissToast(toast.id)">Fechar</button>
      </div>
    </template>
  </div>

  <!-- ========================================== -->
  <!-- SCRIPTS ESPECÍFICOS DO DASHBOARD            -->
  <!-- ========================================== -->
  <script>
    function dashboardApp() {
      const supabaseUrl = window.env?.SUPABASE_URL || window.SUPABASE_URL || '';
      const supabaseKey = window.env?.SUPABASE_ANON_KEY || window.SUPABASE_ANON_KEY || '';
      const supabaseClient = (supabaseUrl && supabaseKey && window.supabase) ? window.supabase.createClient(supabaseUrl, supabaseKey) : null;

      return {
        theme: document.documentElement.dataset.theme || 'light',
        filters: { period: '30d', status: 'all', source: 'all', squad: 'alpha', search: '' },
        modal: null,
        copilot: { prompt: '', answer: '' },
        kpis: [],
        heatmap: [],
        cohorts: [],
        activity: [],
        leaderboard: [],
        widgets: [],
        navigation: [],
        toasts: [],
        leadChart: null,
        pipelineChart: null,
        detailedPipelineChart: null,
        mapInstance: null,

        init() {
          this.navigation = buildNavigation();
          this.kpis = sampleKpis();
          this.heatmap = sampleHeatmap();
          this.cohorts = sampleCohorts();
          this.activity = sampleActivity();
          this.leaderboard = sampleLeaderboard();
          this.widgets = sampleWidgets();
          this.$nextTick(() => {
            this.renderCharts();
            this.initRealtime();
            this.initMap();
            this.initSortable();
          });
          window.addEventListener('online', () => this.toggleOffline(false));
          window.addEventListener('offline', () => this.toggleOffline(true));
        },

        toggleSidebar() {
          document.getElementById('sidebar')?.classList.toggle('hidden');
        },

        toggleTheme() {
          this.theme = this.theme === 'light' ? 'dark' : 'light';
          document.documentElement.classList.toggle('dark', this.theme === 'dark');
          document.documentElement.dataset.theme = this.theme;
          localStorage.setItem('alsham-theme', this.theme);
        },

        toggleNotifications() {
          this.showToast('Centro de notificações', 'Em breve: notificações em tempo real integradas ao Supabase.');
        },

        toggleAccount() {
          this.showToast('Conta', 'Gerencie sua conta em configurações avançadas.');
        },

        toggleOffline(state) {
          const indicator = document.getElementById('offline-indicator');
          if (!indicator) return;
          indicator.classList.toggle('hidden', !state);
        },

        applyFilters() {
          this.showToast('Filtros aplicados', 'KPIs recalculados com sucesso.');
        },

        saveFilter() {
          this.showToast('Filtro salvo', 'Disponível em "Meus filtros".');
        },

        resetFilters() {
          this.filters = { period: '30d', status: 'all', source: 'all', squad: 'alpha', search: '' };
          this.applyFilters();
        },

        exportKpis(type) {
          this.showToast('Exportação iniciada', `Gerando arquivo ${type.toUpperCase()} com seus indicadores.`);
        },

        exportActivity(type) {
          this.showToast('Exportação de atividade', `Exportando feed em ${type.toUpperCase()}.`);
        },

        toggleLeadView(view) {
          this.showToast('Visualização alterada', `Modo ${view === 'donut' ? 'Donut' : 'Funil'} selecionado.`);
        },

        openKpi(card) {
          this.showToast(card.title, 'Abrindo drill-down avançado.');
        },

        openModal(id) {
          this.modal = id;
          if (id === 'pipelineForecast') {
            this.$nextTick(() => this.renderDetailedChart());
          }
        },

        closeModal() {
          this.modal = null;
          if (this.detailedPipelineChart) {
            this.detailedPipelineChart.destroy();
            this.detailedPipelineChart = null;
          }
        },

        askCopilot() {
          const prompt = this.copilot.prompt.trim();
          if (!prompt) {
            this.showToast('Copilot', 'Descreva o cenário desejado.');
            return;
          }
          this.copilot.answer = 'Analisando dados históricos, sugerimos priorizar campanhas de account-based marketing para o segmento Enterprise e ativar automações omnichannel com follow-ups a cada 48h.';
        },

        initRealtime() {
          if (!supabaseClient) return;
          supabaseClient.channel('realtime-dashboard')
            .on('postgres_changes', { event: '*', schema: 'public', table: 'leads' }, payload => {
              this.showToast('Atualização em tempo real', `Lead ${payload.new?.name || payload.old?.name || ''} atualizado.`);
            })
            .subscribe();
        },

        initSortable() {
          if (!window.Sortable) return;
          const zone = this.$refs.widgetZone;
          if (!zone) return;
          Sortable.create(zone, {
            animation: 150,
            handle: '.rounded-3xl',
            ghostClass: 'opacity-60',
            onEnd: () => this.showToast('Layout atualizado', 'Nova ordem salva localmente.'),
          });
        },

        saveLayout() {
          this.showToast('Layout', 'Layout salvo com sucesso.');
        },

        toggleWidgetEdit() {
          this.showToast('Widgets', 'Arraste os cards para reorganizar.');
        },

        openWidget(id) {
          this.showToast('Widget', `Abrindo widget ${id}.`);
        },

        syncMap() {
          this.showToast('Mapa', 'Sincronizando coordenadas com dados mais recentes.');
        },

        initMap() {
          if (!window.L) return;
          this.mapInstance = L.map('map-dashboard', { zoomControl: false }).setView([-23.55052, -46.633308], 4);
          L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '&copy; OpenStreetMap contributors' }).addTo(this.mapInstance);
          sampleMapMarkers().forEach(point => {
            L.circleMarker(point.coords, { radius: 8, color: '#4f46e5', fillColor: '#6366f1', fillOpacity: 0.6 })
              .addTo(this.mapInstance)
              .bindTooltip(`${point.name} — R$ ${point.value}`);
          });
        },

        renderCharts() {
          const sparkOptions = {
            responsive: true,
            maintainAspectRatio: false,
            elements: { point: { radius: 0 } },
            plugins: { legend: { display: false }, tooltip: { enabled: false } },
            scales: { x: { display: false }, y: { display: false } },
          };
          this.kpis.forEach(card => {
            const ctx = document.getElementById(`spark-${card.id}`);
            if (!ctx) return;
            new Chart(ctx, {
              type: 'line',
              data: { labels: card.series.map((_, idx) => idx + 1), datasets: [{ data: card.series, borderColor: '#6366f1', borderWidth: 2, tension: 0.4 }] },
              options: sparkOptions,
            });
          });

          const pipelineCtx = document.getElementById('chart-pipeline');
          if (pipelineCtx) {
            this.pipelineChart = new Chart(pipelineCtx, {
              type: 'line',
              data: {
                labels: ['Semana 1', 'Semana 2', 'Semana 3', 'Semana 4'],
                datasets: [
                  { label: 'Receita prevista', data: [1.2, 1.9, 2.4, 3.1], borderColor: '#2563eb', tension: 0.4, fill: false },
                  { label: 'Meta', data: [1.4, 2.1, 2.8, 3.5], borderColor: '#f97316', borderDash: [6, 6], tension: 0.4, fill: false }
                ],
              },
              options: {
                responsive: true,
                plugins: { legend: { display: true }, annotation: { annotations: {} } },
                scales: { y: { ticks: { callback: value => `R$ ${value.toFixed(1)}M` } } },
              },
            });
          }

          const leadsCtx = document.getElementById('chart-leads');
          if (leadsCtx) {
            this.leadChart = new Chart(leadsCtx, {
              type: 'doughnut',
              data: {
                labels: ['Web', 'Ads', 'Email', 'Parceiros', 'Eventos'],
                datasets: [{ data: [32, 24, 18, 16, 10], backgroundColor: ['#6366f1', '#22c55e', '#f97316', '#0ea5e9', '#a855f7'] }],
              },
              options: { responsive: true, plugins: { legend: { position: 'bottom' } } },
            });
          }
        },

        renderDetailedChart() {
          const ctx = document.getElementById('chart-pipeline-detailed');
          if (!ctx) return;
          this.detailedPipelineChart = new Chart(ctx, {
            type: 'bar',
            data: {
              labels: ['Base', 'Otimista', 'Conservador'],
              datasets: [{ label: 'Receita prevista (R$M)', data: [4.1, 5.3, 3.4], backgroundColor: ['#6366f1', '#22d3ee', '#f97316'] }],
            },
            options: {
              responsive: true,
              plugins: { legend: { display: false } },
              scales: { y: { beginAtZero: true } },
            },
          });
        },

        launchCelebration() {
          if (window.confetti) {
            window.confetti({ particleCount: 160, spread: 70, origin: { y: 0.6 } });
          }
          this.showToast('Parabéns!', 'Metas batidas pela squad Alpha.');
        },

        showToast(title, message) {
          const id = crypto.randomUUID();
          this.toasts.push({ id, title, message });
          setTimeout(() => this.dismissToast(id), 5000);
        },

        dismissToast(id) {
          this.toasts = this.toasts.filter(toast => toast.id !== id);
        },

        navigationCount() {
          return this.navigation.reduce((total, group) => total + group.links.length, 0);
        }
      };
    }

    function buildNavigation() {
      return [
        {
          id: 'core',
          label: 'Core',
          icon: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" /></svg>',
          links: [
            { href: '/dashboard', label: 'Dashboard' },
            { href: '/auth-dashboard', label: 'Auth Dashboard' },
            { href: '/create-org', label: 'Criar Organização' },
            { href: '/timeline-test', label: 'Timeline' },
            { href: '/session-guard', label: 'Session Guard' },
            { href: '/token-refresh', label: 'Token Refresh' },
            { href: '/server-status', label: 'Status do Servidor' }
          ],
        },
        {
          id: 'sales',
          label: 'Vendas & CRM',
          icon: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 3h18v6H3z"/><path stroke-linecap="round" stroke-linejoin="round" d="M3 9h18v6H3z"/><path stroke-linecap="round" stroke-linejoin="round" d="M3 15h18v6H3z"/></svg>',
          links: [
            { href: '/leads-real', label: 'Leads' },
            { href: '/contacts', label: 'Contatos' },
            { href: '/accounts', label: 'Contas' },
            { href: '/opportunities', label: 'Oportunidades' },
            { href: '/deals', label: 'Negócios' },
            { href: '/quotes', label: 'Propostas' },
            { href: '/contracts', label: 'Contratos' },
            { href: '/invoices', label: 'Faturas' },
            { href: '/products', label: 'Produtos' },
            { href: '/price-lists', label: 'Listas de Preço' },
            { href: '/sales-forecasting', label: 'Previsão de Vendas' },
            { href: '/pipeline', label: 'Pipeline' }
          ],
        },
        {
          id: 'marketing',
          label: 'Marketing',
          icon: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 11l18-5-3 11-7 2-5-8z" /></svg>',
          links: [
            { href: '/campaigns', label: 'Campanhas' },
            { href: '/email-campaigns', label: 'Email Marketing' },
            { href: '/landing-pages', label: 'Landing Pages' },
            { href: '/forms', label: 'Formulários' },
            { href: '/social-media', label: 'Redes Sociais' },
            { href: '/seo', label: 'SEO' },
            { href: '/ads-manager', label: 'Anúncios' },
            { href: '/content-library', label: 'Biblioteca de Conteúdo' },
            { href: '/ab-tests', label: 'Testes A/B' },
            { href: '/journeys', label: 'Customer Journeys' }
          ],
        },
        {
          id: 'support',
          label: 'Suporte',
          icon: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M18 10a6 6 0 0 0-12 0v5h12v-5z"/><path stroke-linecap="round" stroke-linejoin="round" d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>',
          links: [
            { href: '/tickets', label: 'Tickets' },
            { href: '/knowledge-base', label: 'Base de Conhecimento' },
            { href: '/live-chat', label: 'Chat ao Vivo' },
            { href: '/service-level-agreements', label: 'SLAs' },
            { href: '/case-management', label: 'Gestão de Casos' },
            { href: '/customer-portal', label: 'Portal do Cliente' },
            { href: '/feedback', label: 'Feedback' }
          ],
        },
        {
          id: 'comm',
          label: 'Comunicação',
          icon: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" /></svg>',
          links: [
            { href: '/inbox', label: 'Inbox' },
            { href: '/email', label: 'Email' },
            { href: '/calls', label: 'Ligações' },
            { href: '/meetings', label: 'Reuniões' },
            { href: '/sms', label: 'SMS' },
            { href: '/whatsapp', label: 'WhatsApp' },
            { href: '/video', label: 'Video Calls' },
            { href: '/voice-analytics', label: 'Voice Analytics' }
          ],
        },
        {
          id: 'automation',
          label: 'Automação',
          icon: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path stroke-linecap="round" stroke-linejoin="round" d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9c0 .69.28 1.35.77 1.83.48.49 1.14.77 1.83.77H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z" /></svg>',
          links: [
            { href: '/automacoes', label: 'Workflows' },
            { href: '/sequences', label: 'Sequências' },
            { href: '/playbooks', label: 'Playbooks' },
            { href: '/customer-journeys', label: 'Journeys Dinâmicos' },
            { href: '/webhooks', label: 'Webhooks' },
            { href: '/integrations-zapier', label: 'Zapier' }
          ],
        },
        {
          id: 'productivity',
          label: 'Produtividade',
          icon: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2M9 5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2"/></svg>',
          links: [
            { href: '/tasks', label: 'Tarefas' },
            { href: '/calendar', label: 'Calendário' },
            { href: '/approvals', label: 'Aprovações' },
            { href: '/notes', label: 'Notas Inteligentes' },
            { href: '/documentos', label: 'Documentos' }
          ],
        },
        {
          id: 'team',
          label: 'Equipe & Gamificação',
          icon: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 0 0-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 0 1 5.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857a5.002 5.002 0 0 1 9.288 0M15 7a3 3 0 1 1-6 0 3 3 0 0 1 6 0zm6 3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zM7 10a2 2 0 1 1-4 0 2 2 0 0 1 4 0z"/></svg>',
          links: [
            { href: '/team', label: 'Equipe' },
            { href: '/users', label: 'Usuários' },
            { href: '/roles-permissions', label: 'Roles & Permissões' },
            { href: '/territories', label: 'Territórios' },
            { href: '/commissions', label: 'Comissões' },
            { href: '/goals', label: 'Metas' },
            { href: '/leaderboards', label: 'Leaderboards' },
            { href: '/gamificacao', label: 'Gamificação' }
          ],
        },
        {
          id: 'analytics',
          label: 'Analytics & BI',
          icon: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 21v-7M9 21V3M14 21v-4M19 21v-11"/></svg>',
          links: [
            { href: '/relatorios', label: 'Relatórios' },
            { href: '/analytics', label: 'Analytics Avançado' },
            { href: '/forecasting', label: 'Previsões' },
            { href: '/roi-calculator', label: 'ROI' },
            { href: '/cohort-analysis', label: 'Cohort' },
            { href: '/attribution', label: 'Atribuição' },
            { href: '/executive-dashboard', label: 'Dashboard Executivo' },
            { href: '/data-studio', label: 'Data Studio' }
          ],
        },
        {
          id: 'integrations',
          label: 'Integrações',
          icon: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m0 0h4M8 3 3 8m13 9v4m0 0h4m-4 0 5-5M7 8H3m0 0v4m0-4 5 5m9-5h4m0 0v4m0-4-5 5"/></svg>',
          links: [
            { href: '/integrations', label: 'Marketplace' },
            { href: '/app-marketplace', label: 'Apps' },
            { href: '/api-console', label: 'API Console' },
            { href: '/webhooks', label: 'Webhooks' },
            { href: '/data-import-export', label: 'Import/Export' },
            { href: '/sso', label: 'Single Sign-On' }
          ],
        },
        {
          id: 'settings',
          label: 'Configurações',
          icon: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 0 0 1.066 2.573c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 0 0-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 0 0-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 0 0-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 0 0-1.066-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 0 0 1.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/></svg>',
          links: [
            { href: '/configuracoes', label: 'Geral' },
            { href: '/settings-notifications', label: 'Notificações' },
            { href: '/settings-email', label: 'Email' },
            { href: '/settings-billing', label: 'Faturamento' },
            { href: '/settings-branding', label: 'Branding' },
            { href: '/settings-custom-fields', label: 'Campos Custom' },
            { href: '/settings-data-privacy', label: 'Privacidade' }
          ],
        },
        {
          id: 'innovation',
          label: 'IA & Inovação',
          icon: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v4m0 10v4m9-9h-4M7 12H3m15.364 6.364-2.828-2.828M8.464 8.464 5.636 5.636m0 12.728 2.828-2.828m9.9-9.9L18.364 5.636"/></svg>',
          links: [
            { href: '/ai-assistant', label: 'Assistente IA' },
            { href: '/copilot', label: 'Copilot' },
            { href: '/voice-commands', label: 'Comandos de Voz' },
            { href: '/virtual-office', label: 'Escritório Virtual' },
            { href: '/nft-rewards', label: 'NFT Rewards' },
            { href: '/metaverse', label: 'Metaverso' },
            { href: '/sustainability', label: 'ESG' },
            { href: '/diversity-inclusion', label: 'D&I' }
          ],
        },
        {
          id: 'extras',
          label: 'Mobile & Extras',
          icon: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="7" y="2" width="10" height="20" rx="2" ry="2"/><path stroke-linecap="round" stroke-linejoin="round" d="M11 18h2"/></svg>',
          links: [
            { href: '/mobile-app', label: 'App Mobile' },
            { href: '/help-center', label: 'Ajuda' },
            { href: '/whats-new', label: 'Novidades' },
            { href: '/resources', label: 'Recursos' },
            { href: '/community', label: 'Comunidade' },
            { href: '/onboarding', label: 'Onboarding' },
            { href: '/guided-tour', label: 'Tour Guiado' },
            { href: '/setup-wizard', label: 'Wizard' },
            { href: '/data-migration', label: 'Migração' },
            { href: '/success-stories', label: 'Casos de Sucesso' }
          ],
        }
      ];
    }

    function sampleKpis() {
      return [
        { id: 'revenue', title: 'Receita Reconhecida', value: 'R$ 3,1M', trend: 12, trendLabel: '+12% vs. mês anterior', series: [2.2, 2.4, 2.7, 3.1], period: '30 dias', category: 'Vendas', subtitle: 'Meta: R$ 3,5M' },
        { id: 'conversion', title: 'Taxa de Conversão', value: '28,4%', trend: 4, trendLabel: '+4pts', series: [22, 24, 26, 28.4], period: '30 dias', category: 'Marketing', subtitle: 'Meta: 30%' },
        { id: 'nps', title: 'NPS Global', value: '71', trend: 6, trendLabel: '+6pts', series: [58, 62, 65, 71], period: 'Quarter', category: 'Sucesso do Cliente', subtitle: 'Benchmark: 60' },
        { id: 'tickets', title: 'Tempo Médio de Ticket', value: '1,8h', trend: -9, trendLabel: '-9% vs. meta', series: [2.4, 2.1, 1.9, 1.8], period: '7 dias', category: 'Suporte', subtitle: 'SLA: 2h' },
        { id: 'churn', title: 'Churn Mensal', value: '1,2%', trend: -0.3, trendLabel: '-0,3pts', series: [2.1, 1.9, 1.5, 1.2], period: 'Mês', category: 'Sucesso do Cliente', subtitle: 'Meta: 1%' },
        { id: 'mql', title: 'MQLs Gerados', value: '1.264', trend: 18, trendLabel: '+18% vs. meta', series: [890, 1020, 1150, 1264], period: '30 dias', category: 'Marketing', subtitle: 'Meta: 1.050' },
        { id: 'automation', title: 'Fluxos Automatizados', value: '86 ativos', trend: 9, trendLabel: '+9 novos', series: [62, 71, 77, 86], period: 'Quarter', category: 'Operações', subtitle: 'Cobertura: 82%' },
        { id: 'training', title: 'Treinamentos concluídos', value: '94%', trend: 11, trendLabel: '+11pts', series: [66, 72, 83, 94], period: 'Quarter', category: 'RH & Enablement', subtitle: 'Meta: 95%' }
      ];
    }

    function sampleHeatmap() {
      const squads = ['Alpha', 'Beta', 'Gamma', 'Delta', 'Epsilon', 'Zeta', 'Omega'];
      const days = ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'];
      let id = 0;
      return squads.flatMap((squad, row) => days.map((day, col) => {
        const value = Math.floor(Math.random() * 100);
        const intensity = Math.max(20, value);
        return {
          id: `${row}-${col}`,
          label: `${squad} ${day}: ${value}% de adoção`,
          value,
          color: `rgba(99, 102, 241, ${intensity / 120})`
        };
      }));
    }

    function sampleCohorts() {
      return [
        { month: 'Jan/25', retention: 84 },
        { month: 'Fev/25', retention: 81 },
        { month: 'Mar/25', retention: 78 },
        { month: 'Abr/25', retention: 74 },
        { month: 'Mai/25', retention: 69 }
      ];
    }

    function sampleActivity() {
      return [
        { id: 1, title: 'Deal fechado - Conta Globex', description: 'Contratação enterprise em 36 meses. Valor: R$ 1,2M ARR.', time: 'há 12 min', tags: ['Deal', 'Enterprise'], critical: true },
        { id: 2, title: 'Campanha ABM ativada', description: 'Sequência multicanal para 45 contas prioritárias.', time: 'há 35 min', tags: ['Marketing', 'ABM'], critical: false },
        { id: 3, title: 'Lead marcado como Hot', description: 'Score 92 — solicitar follow-up executivo.', time: 'há 1h', tags: ['Lead', 'Score'], critical: false },
        { id: 4, title: 'Ticket crítico resolvido', description: 'Bug em integração Salesforce solucionado.', time: 'há 2h', tags: ['Suporte', 'SLA'], critical: true }
      ];
    }

    function sampleLeaderboard() {
      return [
        { id: 1, rank: '1º', name: 'Ana Martins', badge: 'Closer Supreme', points: 1840, delta: '+120 pts' },
        { id: 2, rank: '2º', name: 'Carlos Lima', badge: 'IA Specialist', points: 1710, delta: '+85 pts' },
        { id: 3, rank: '3º', name: 'Beatriz Souza', badge: 'Pipeline Master', points: 1665, delta: '+60 pts' },
        { id: 4, rank: '4º', name: 'Diego Santos', badge: 'CS Hero', points: 1510, delta: '+45 pts' }
      ];
    }

    function sampleWidgets() {
      return [
        { id: 'ai-insights', title: 'Insights IA', description: 'Resumo diário gerado pelo Copilot.', content: '<ul class="list-disc space-y-2 pl-4"><li>Segmento enterprise com maior propensão a upsell.</li><li>Recomenda 12 follow-ups personalizados.</li></ul>' },
        { id: 'playbooks', title: 'Playbooks ativos', description: 'Sequências críticas em execução.', content: '<ol class="list-decimal space-y-1 pl-4"><li>Renovação Proativa</li><li>Upsell CX+</li><li>Reativação Leads Frios</li></ol>' },
        { id: 'health', title: 'Health Score', description: 'Clientes com risco monitorado.', content: '<p class="font-semibold">86% dos clientes com health score &gt; 80.</p>' }
      ];
    }

    function sampleMapMarkers() {
      return [
        { name: 'São Paulo', value: '820K', coords: [-23.55052, -46.633308] },
        { name: 'Rio de Janeiro', value: '420K', coords: [-22.906847, -43.172896] },
        { name: 'Belo Horizonte', value: '210K', coords: [-19.916681, -43.934493] },
        { name: 'Curitiba', value: '180K', coords: [-25.428954, -49.273251] },
        { name: 'Porto Alegre', value: '160K', coords: [-30.034647, -51.217658] }
      ];
    }
  </script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').catch(() => {
        console.warn('Service worker não pôde ser registrado.');
      });
    }
  </script>
</body>
</html>
